# ローカル現行環境ステージングの設定

ローカル現行環境ステージングでは、ステージング環境と本番環境の両方が同じLiferayサーバーでホストされます。 有効にすると、Liferay DXPは、ステージング環境として機能するサイトまたはアセットライブラリのローカルクローンを作成し、元のサイトまたはアセットライブラリが本番環境になります。 両方の環境は、同じJVM、データベース、選択されたアプリケーションデータ、および構成（ポータルプロパティなど）を共有します。

<a name="setting-up-local-live-staging-for-sites" />

## サイトのローカル現行環境ステージングの設定

1. ［**サイトメニュー**］ &rarr; ［**Publishing**］ &rarr; ［**Staging**］ に移動します。

   ![サイトメニューの［ステージング］に移動します。](./configuring-local-live-staging/images/01.png)

1. ［**Local Live**］ を選択すると、 ［**ページバージョニング**］ と ［**ステージコンテンツ**］ の追加フィールドが表示されます。

   ![ [ローカル現行環境]を選択します。](./configuring-local-live-staging/images/02.png)

1. ［**Page Versioning**］ をパブリックページセットまたはプライベートページセット、あるいはその両方で有効にするかどうかを選択します。

   ![ページバージョニングをプライベートページセットとパブリックページセットで有効にします。](./configuring-local-live-staging/images/03.png)

1. ステージングするデータとコンテンツのタイプを選択します。

   ![ステージングするデータとコンテンツのタイプを選択します。](./configuring-local-live-staging/images/04.png)

   ```{warning}
   アプリケーションをチェックすると、そのデータがステージングにコピーされ、本番環境で直接編集できない場合があります。 アプリケーションのチェックを外す場合は、ステージングでの変更が失われる可能性があるため、まずステージングでの変更が公開されていることを確認してください。 詳細については、 [ステージングでのデータとコンテンツタイプの管理](./managing-data-and-content-types-in-staging.md) を参照してください。
   ```

1. ［**保存**］ をクリックして、クローン作成プロセスを開始します。 このプロセスの期間は、サイトのサイズによって異なります。

   ```{tip}
   更新はページバージョニングを有効にした場合にのみ記録されるため、サイトを早い段階でステージングして、クローン作成時間を短縮し、サイトの更新履歴をより完全に記録できるようにします。
   ```

プロセスが完了すると、ローカル現行環境ステージングを使用する準備が整います。 ステージング環境の公開機能のナビゲートについては、 [サイトステージングUIリファレンス](./site-staging-ui-reference.md) を参照してください。

<a name="setting-up-staging-for-asset-libraries" />

## アセットライブラリのステージングの設定

1. **グローバルメニュー**（![Global Menu](../../../images/icon-applications-menu.png)）を開き、［Applications］タブの ［**アセットライブラリ**］ をクリックします。

1. 目的のアセットライブラリを開き、［公開設定］の下の ［**ステージング**］ をクリックします。

1. ［**Local Live**］ を選択します。

   ![ [ローカル現行環境]を選択します。](./configuring-local-live-staging/images/05.png)

1. ステージングするアプリケーションデータを選択します。

   アセットライブラリの場合、 **ドキュメントとメディア** 、および **Webコンテンツ** のデータをステージングできます。

   ![ステージングするアプリケーションデータを選択します。](./configuring-local-live-staging/images/06.png)

1. ［**保存**］ をクリックして、クローン作成プロセスを開始します。 このプロセスの時間は、アセットライブラリのサイズによって異なります。

   プロセスが完了すると、アセットライブラリでローカル現行環境ステージングを使用する準備が整います。

<a name="disabling-local-live-staging" />

## ローカル現行環境ステージングの無効化

何らかの理由でサイトまたはアセットライブラリのステージングを無効にする必要がある場合は、ステージング環境から無効にすることができます。 ただし、ローカル現行環境ステージングを無効にすると、すべての未公開コンテンツとともにステージング環境が削除されることに注意してください。 このため、ステージングを無効にする前に、必要なすべての情報が他の場所で公開または保存されていることを確認してください。

```{tip}
ステージング環境のサイズによっては、このプロセスに時間がかかる場合があります。 DXPインスタンスが処理中の場合は、ステージングを無効にしないことをお勧めします。
```

ローカル現行環境ステージングを無効にするには、次の手順に従います。

1. サイトまたはアセットライブラリでステージングアプリケーションを開きます。

1. アプリケーションバーの **アクション**（![Actions button](../../../images/icon-actions.png)）をクリックし、 ［**Staging Configuration**］ を選択します。

   ![アプリケーションバーのアクションボタンをクリックし、［ステージング設定］を選択します](./configuring-local-live-staging/images/07.png)

1. ステージング設定で ［**None**］ を選択し、 ［**保存**］ をクリックします。

<a name="additional-information" />

## 追加情報

* [ステージングの概要](../staging.md)
* [サイトステージングUIリファレンス](./site-staging-ui-reference.md)
* [ステージングでのデータとコンテンツタイプの管理](./managing-data-and-content-types-in-staging.md)
* [ステージング権限の管理](./managing-staging-permissions.md)
